<!DOCTYPE html>
<html lang="en">
    <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Installation</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="Martin Fenner" />

    <!-- RDFa Metadata (in DublinCore) -->
    <meta property="dc:title" content="Installation" />
    <meta property="dc:creator" content="" />
    <meta name="citation_publication_date" content=""/>
    <meta property="dc:format" content="text/html" />
    <meta property="dc:language" content="en" />
    <meta property="dc:identifier" content="/docs/installation/" />
    <meta property="dc:rights" content="CC-BY" />
    <meta property="dc:source" content="Article-Level Metrics" />
    <meta property="dc:subject" content="Scholarly Communication" />
    <meta property="dc:type" content="website" />

    <!-- Google Scholar Metadata -->
    <meta name="citation_author" content=""/>
    <meta name="citation_publication_date" content=""/>
    <meta name="citation_title" content="Installation"/>
    <meta name="citation_journal_title" content="Article-Level Metrics"/>

    <link rel="alternate" type="application/rss+xml" title="Article-Level Metrics" href="/rss.xml" />
    <link rel="alternate" type="application/atom+xml" title="Article-Level Metrics" href="/atom.xml" />

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Fonts -->
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600,400italic,600italic' rel='stylesheet' type='text/css'>

    <!-- CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/bootstrap-theme.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/github.css">

    <!-- Javascript -->
    <script src="/js/d3.v3.min.js"></script>
  </head>
  <body>
    <nav class="navbar navbar-inverse navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#">ALM</a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="/">Introduction</a></li>
            <li><a href="/metrics">Metrics</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Implementations <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="/plos">Public Library of Science</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Development <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="/docs/">Home</a></li>
            <li><a href="/docs/installation">Installation</a></li>
            <li><a href="/docs/setup">Setup</a></li>
            <li><a href="/docs/sources">Sources</a></li>
            <li><a href="/docs/api">API</a></li>
            <li><a href="/docs/rake">Rake</a></li>
            <li><a href="/docs/alerts">Alerts</a></li>
            <li><a href="/docs/faq">FAQ</a></li>
            <li><a href="/docs/releases">Releases</a></li>
            <li><a href="/docs/roadmap">Roadmap</a></li>
            <li><a href="/docs/contributors">Contributors</a></li>
          </ul>
        </li>
        <li><a href="/examples">Examples</a></li>
        <li><a href="/blog">Blog</a></li>
        <li><a href="/status">Status</a></li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container">
      <div class="page-header">
        <h1>Installation</h1>
        <p class="subtitle">
        </p>
      </div>

      <div class="content">
        <div class="row">
          <div class="col-md-9">
            
            <p>ALM is a typical Ruby on Rails web application with one unusual feature: it requires the CouchDB database. CouchDB is used to store the responses from external API calls, MySQL (or PostgreSQL, see below) is used for everything else. The application has been tested with Apache/Passenger, but should also run in other deployment environments, e.g. Nginx/Unicorn or WEBrick. ALM uses Ruby on Rails 3.2.x, migration to Rails 4.x is planned for 2014. The application has extensive test coverage using <a href="http://rspec.info/">Rspec</a> and <a href="http://cukes.info/">Cucumber</a>.</p>

<p>The ALM application is available as Open Source software using a <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache license</a>, all dependencies (software and libraries) are also Open Source.</p>

<p>Because of the background workers that talk to external APIs we recommend at least 1 Gb of RAM, and more if you have a large number of articles. As a rule of thumb you need one worker per 5,000 - 20,000 articles, and 1 Gb of RAM per 10 workers - the exact numbers depend on how often you plan to update articles, e.g. you need more workers if you plan on update your usage stats every day.</p>

<h4 id="toc_0">Ruby 1.9</h4>

<p>ALM requires Ruby 1.9.3. Not all Linux distributions include Ruby 1.9 as a standard install, which makes it more difficult than it should be. <a href="http://rvm.io/">RVM</a> and <a href="https://github.com/sstephenson/rbenv">Rbenv</a> are Ruby version management tools for installing Ruby 1.9. Unfortunately they also introduce additional dependencies, making them sometimes not the best choices in a production environment. The ALM application has not been tested with Ruby 2.x, but migration to Ruby 2.1.x is planned for 2014.</p>

<h4 id="toc_1">Installation Options</h4>

<ul>
<li>automated installation via Vagrant and Capistrano (recommended)</li>
<li>manual installation</li>
</ul>

<p>Hosting the ALM application at a Platform as a Service (PaaS) provider such as Heroku or OpenShift is possible, but has not been tested.</p>

<h2 id="toc_2">Automated Installation</h2>

<p>This is the recommended way to install the ALM application. The required applications and libraries will automatically be installed in a self-contained virtual machine, using <a href="http://downloads.vagrantup.com/">Vagrant</a> and <a href="http://docs.opscode.com/chef_solo.html">Chef Solo</a>. We use the <a href="http://capistranorb.com/">Capistrano</a> deployment tool to install the latest ALM code, run database migrations and restart the server.</p>

<p>Start by downloading and installing <a href="http://downloads.vagrantup.com/">Vagrant</a>, and then install the <a href="https://github.com/schisamo/vagrant-omnibus">Omnibus</a> Vagrant plugin (which installs the newest version of Chef Solo):</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">vagrant plugin install vagrant-omnibus
</code></pre></div>
<p>The following providers have been tested with the ALM application:</p>

<ul>
<li>Virtualbox</li>
<li>VMware Fusion or Workstation</li>
<li>Amazon AWS</li>
<li>Digital Ocean</li>
<li>Rackspace</li>
</ul>

<p>Virtualbox and VMware are for local installations, e.g. on a developer machine, whereas the other options are for cloud installations. With the exception of Virtualbox you need to install the appropriate <a href="https://github.com/mitchellh/vagrant/wiki/Available-Vagrant-Plugins">Vagrant plugin</a> with these providers, e.g. for AWS:</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">vagrant plugin install vagrant-aws
</code></pre></div>
<p>The VMware plugin requires a commercial license, all other plugins are freely available as Open Source software.</p>

<h3 id="toc_3">Custom settings (passwords, API keys)</h3>

<p>This is an optional step. Rename the file <code>config.json.example</code> to <code>config.json</code> and add your custom settings to it, including usernames, passwords, API keys and the MySQL password. This will automatically configure the application with your settings.</p>

<p>Some custom settings for the virtual machine are stored in the <code>Vagrantfile</code>, and that includes your cloud provider access keys, the ID base virtual machine with Ubuntu 12.04 from by your cloud provider, RAM for the virtual machine, and networking settings for a local installation. A sample configuration for AWS would look like:</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">hostname</span> <span class="o">=</span> <span class="s2">&quot;alm&quot;</span>

<span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provider</span> <span class="ss">:aws</span> <span class="k">do</span> <span class="o">|</span><span class="n">aws</span><span class="p">,</span> <span class="n">override</span><span class="o">|</span>
  <span class="n">aws</span><span class="o">.</span><span class="n">access_key_id</span> <span class="o">=</span> <span class="s2">&quot;EXAMPLE&quot;</span>
  <span class="n">aws</span><span class="o">.</span><span class="n">secret_access_key</span> <span class="o">=</span> <span class="s2">&quot;EXAMPLE&quot;</span>
  <span class="n">aws</span><span class="o">.</span><span class="n">keypair_name</span> <span class="o">=</span> <span class="s2">&quot;EXAMPLE&quot;</span>
  <span class="n">aws</span><span class="o">.</span><span class="n">security_groups</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;EXAMPLE&quot;</span><span class="o">]</span>
  <span class="n">aws</span><span class="o">.</span><span class="n">instance_type</span> <span class="o">=</span> <span class="s1">&#39;m1.small&#39;</span>
  <span class="n">aws</span><span class="o">.</span><span class="n">ami</span> <span class="o">=</span> <span class="s2">&quot;ami-e7582d8e&quot;</span>
  <span class="n">aws</span><span class="o">.</span><span class="n">tags</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">Name</span><span class="p">:</span> <span class="s1">&#39;Vagrant alm&#39;</span> <span class="p">}</span>

  <span class="n">override</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="s2">&quot;ubuntu&quot;</span>
  <span class="n">override</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">private_key_path</span> <span class="o">=</span> <span class="s2">&quot;/EXAMPLE.pem&quot;</span>
<span class="k">end</span>
</code></pre></div>
<p>The sample configuration for AWS and Digital Ocean is included in the <code>Vagrantfile</code>.</p>

<p>Then install all the required software for the ALM application with:</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">git clone git://github.com/articlemetrics/alm.git
<span class="nb">cd </span>alm
vagrant up
</code></pre></div>
<p>This installs the ALM server on a Ubuntu 12.04 virtual machine and can take up to 15 min. To get into in the virtual machine, use user <code>vagrant</code> with password <code>vagrant</code> or do:</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">vagrant ssh
<span class="nb">cd</span> /vagrant
</code></pre></div>
<p>This uses the private SSH key provided by you in the <code>Vagrantfile</code> (the default key for local installations using Virtualbox is <code>~/.vagrant.d/insecure_private_key</code>). The <code>vagrant</code> user has sudo privileges. The MySQL password is stored at <code>config/database.yml</code>, and is auto-generated during the installation. CouchDB is set up to run in <strong>Admin Party</strong> mode, i.e. without usernames or passwords. The database servers can be reached from the virtual machine or via port forwarding (configured in <code>Vagrantfile</code>). Vagrant syncs the folder on the host containing the checked out ALM git repo with the folder <code>/var/www/alm/shared</code> on the guest.</p>

<h2 id="toc_4">Deployment via Capistrano</h2>

<p>Using the deployment automation tool <a href="http://capistranorb.com">Capistrano</a> is the recommended strategy for code updates via git, database migrations and server restarts. Capistrano assumes that the server has been provisioned using Vagrant or Chef (or via manual installation, see below).</p>

<p>To use Capistrano you need Ruby (at least 1.9.3) installed on your local machine. If you haven&#39;t done so, install <a href="http://bundler.io/">Bundler</a> to manage the dependencies for the ALM application:</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">gem install bundler
</code></pre></div>
<p>Then go to the ALM git repo that you probably have already cloned in the installation step and install all required dependencies.</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">git clone git://github.com/articlemetrics/alm.git
<span class="nb">cd </span>alm
bundle install
</code></pre></div>
<h4 id="toc_5">Edit deployment configuration</h4>

<p>The deployment settings for the development environment and the Virtualbox VM created by Vagrant is already configured:</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="n">set</span> <span class="ss">:stage</span><span class="p">,</span> <span class="ss">:development</span>
<span class="n">set</span> <span class="ss">:branch</span><span class="p">,</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;REVISION&quot;</span><span class="o">]</span> <span class="o">||</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;BRANCH_NAME&quot;</span><span class="o">]</span> <span class="o">||</span> <span class="s2">&quot;develop&quot;</span>
<span class="n">set</span> <span class="ss">:deploy_user</span><span class="p">,</span> <span class="s1">&#39;vagrant&#39;</span>
<span class="n">set</span> <span class="ss">:rails_env</span><span class="p">,</span> <span class="ss">:development</span>

<span class="c1"># install all gems into system</span>
<span class="n">set</span> <span class="ss">:bundle_without</span><span class="p">,</span> <span class="kp">nil</span>
<span class="n">set</span> <span class="ss">:bundle_binstubs</span><span class="p">,</span> <span class="kp">nil</span>
<span class="n">set</span> <span class="ss">:bundle_path</span><span class="p">,</span> <span class="kp">nil</span>
<span class="n">set</span> <span class="ss">:bundle_flags</span><span class="p">,</span> <span class="s1">&#39;--system&#39;</span>

<span class="c1"># don&#39;t precompile assets</span>
<span class="n">set</span> <span class="ss">:assets_roles</span><span class="p">,</span> <span class="o">[]</span>

<span class="n">role</span> <span class="ss">:app</span><span class="p">,</span> <span class="sx">%w{33.33.33.44}</span>
<span class="n">role</span> <span class="ss">:web</span><span class="p">,</span> <span class="sx">%w{33.33.33.44}</span>
<span class="n">role</span> <span class="ss">:db</span><span class="p">,</span>  <span class="sx">%w{33.33.33.44}</span>

<span class="n">set</span> <span class="ss">:ssh_options</span><span class="p">,</span> <span class="p">{</span>
  <span class="ss">user</span><span class="p">:</span> <span class="s2">&quot;vagrant&quot;</span><span class="p">,</span>
  <span class="ss">keys</span><span class="p">:</span> <span class="sx">%w(~/.vagrant.d/insecure_private_key)</span><span class="p">,</span>
  <span class="n">auth_methods</span><span class="p">:</span> <span class="sx">%w(publickey)</span>
<span class="p">}</span>

<span class="c1"># Set number of delayed_job workers</span>
<span class="n">set</span> <span class="ss">:delayed_job_args</span><span class="p">,</span> <span class="s2">&quot;-n 3&quot;</span>
</code></pre></div>
<p>For a different setup (e.g. a production server) edit the deployment configuration for Capistrano by renaming the file <code>config/deploy/production.rb.example</code> to <code>config/deploy/production.rb</code> and fill in the following information:</p>

<ul>
<li>server for roles :app, :web, :db (name or IP address, could all be the same server)</li>
<li>:deploy_user</li>
<li>number of background workers, e.g. three workers: :delayed_job_args, &quot;-n 3&quot;</li>
<li>SSH keys via :ssh_options</li>
</ul>

<h4 id="toc_6">Deploy</h4>

<p>We deploy the ALM application with</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">bundle <span class="nb">exec </span>cap production deploy
</code></pre></div>
<p>Replace <code>production</code> with <code>staging</code> or <code>development</code> for other environments. You can pass in environment variables, e.g. to deploy a different branch: <code>cap production deploy BRANCH_NAME=develop</code>.</p>

<p>The first time this command is run it creates the folder structure required by Capistrano, by default in <code>/var/www/alm</code>. To make sure the expected folder structure is created successfully you can run:</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">bundle <span class="nb">exec </span>cap production deploy:check
</code></pre></div>
<p>On subsequent runs the command will pull the latest code from the Github repo, run database migrations, install the dependencies via Bundler, stop and start the background workers, and in production mode precompiles assets (CSS, Javascripts, images).</p>

<h2 id="toc_7">Manual installation</h2>

<p>These instructions assume a fresh installation of Ubuntu 12.04 and a user with sudo privileges. Installation on other Unix/Linux platforms should be similar, but may require additional steps to install Ruby 1.9.</p>

<h4 id="toc_8">Update package lists</h4>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">sudo apt-get update
</code></pre></div>
<h4 id="toc_9">Install required packages</h4>

<p><code>libxml2-dev</code> and <code>libxslt1-dev</code> are required for XML processing by the <code>nokogiri</code> gem, <code>nodejs</code> provides Javascript for the <code>therubyracer</code> gem.</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">sudo apt-get install curl build-essential git-core libxml2-dev libxslt1-dev nodejs
</code></pre></div>
<h4 id="toc_10">Install Ruby 1.9.3</h4>

<p>We only need one Ruby version and manage gems with bundler, so there is no need to install <code>rvm</code> or <code>rbenv</code>.</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">sudo apt-get install ruby1.9.3
</code></pre></div>
<h4 id="toc_11">Install databases</h4>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">sudo apt-get install couchdb mysql-server
</code></pre></div>
<h4 id="toc_12">Install Memcached</h4>

<p>Memcached is used to cache requests (in particular API requests), and the default configuration can be used. If you want to run memcached on a different host, change <code>config.cache_store = :dalli_store, { :namespace =&gt; &quot;alm&quot; }</code> in <code>config/environments/production.rb</code> to <code>config.cache_store = :dalli_store, &#39;cache.example.com&#39;, { :namespace =&gt; &quot;alm&quot; }</code>.</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">sudo apt-get install memcached
</code></pre></div>
<h4 id="toc_13">Install Postfix</h4>

<p>Postfix is used to send reports via email. Alternatively, a different SMTP host can be configured in <code>config/settings.yml</code>.</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">sudo apt-get install postfix
</code></pre></div>
<p>The default configuration assumes <code>address: localhost</code>, <code>port: 25</code>. You can configure mail in <code>config/settings.yml</code>:</p>
<div class="highlight"><pre><code class="yaml language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">mail</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">address</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">port</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">domain</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">user_name</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">password</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">authentication</span><span class="p-Indicator">:</span>
</code></pre></div>
<p>More information can be found <a href="http://guides.rubyonrails.org/action_mailer_basics.html">here</a>.</p>

<h4 id="toc_14">Install Apache and dependencies required for Passenger</h4>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">sudo apt-get install apache2 apache2-prefork-dev libapr1-dev libaprutil1-dev libcurl4-openssl-dev
</code></pre></div>
<h4 id="toc_15">Install and configure Passenger</h4>

<p>Passenger is a Rails application server: <a href="http://www.modrails.com">http://www.modrails.com</a>. Update <code>passenger.load</code> and <code>passenger.conf</code> when you install a new version of the passenger gem.</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">sudo gem install passenger -v 3.0.19
sudo passenger-install-apache2-module --auto

<span class="c"># /etc/apache2/mods-available/passenger.load</span>
LoadModule passenger_module /var/lib/gems/1.9.1/gems/passenger-3.0.19/ext/apache2/mod_passenger.so

<span class="c"># /etc/apache2/mods-available/passenger.conf</span>
PassengerRoot /var/lib/gems/1.9.1/gems/passenger-3.0.19
PassengerRuby /usr/bin/ruby1.9.1

sudo a2enmod passenger
</code></pre></div>
<h4 id="toc_16">Set up virtual host</h4>

<p>Please set <code>ServerName</code> if you have set up more than one virtual host. Also don&#39;t forget to add<code>AllowEncodedSlashes On</code> to the Apache virtual host file in order to keep Apache from messing up encoded embedded slashes in DOIs. Use <code>RailsEnv development</code> to use the Rails development environment.</p>
<div class="highlight"><pre><code class="apache language-apache" data-lang="apache"><span class="c"># /etc/apache2/sites-available/alm</span>
<span class="nt">&lt;VirtualHost</span> <span class="s">*:80</span><span class="nt">&gt;</span>
  <span class="nb">ServerName</span> localhost
  <span class="nb">RailsEnv</span> production
  <span class="nb">DocumentRoot</span> <span class="sx">/var/www/alm/public</span>

  <span class="nt">&lt;Directory</span> <span class="s">/var/www/alm/public</span><span class="nt">&gt;</span>
    <span class="nb">Options</span> FollowSymLinks
    <span class="nb">AllowOverride</span> <span class="k">None</span>
    <span class="nb">Order</span> allow,deny
    <span class="nb">Allow</span> from <span class="k">all</span>
  <span class="nt">&lt;/Directory&gt;</span>

  <span class="c"># Important for ALM: keeps Apache from messing up encoded embedded slashes in DOIs</span>
  <span class="nb">AllowEncodedSlashes</span> <span class="k">On</span>

<span class="nt">&lt;/VirtualHost&gt;</span>
</code></pre></div>
<h4 id="toc_17">Install ALM code</h4>

<p>You may have to set the permissions first, depending on your server setup. Passenger by default is run by the user who owns <code>config.ru</code>.</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">git clone git://github.com/articlemetrics/alm.git /var/www/alm
</code></pre></div>
<h4 id="toc_18">Install Bundler and Ruby gems required by the application</h4>

<p>Bundler is a tool to manage dependencies of Ruby applications: <a href="http://gembundler.com">http://gembundler.com</a>. We have to install <code>therubyracer</code> gem as sudo because of a permission problem (make sure the version matches the version in <code>Gemfile</code> in the ALM root directory).</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">sudo gem install bundler
sudo gem install therubyracer -v <span class="s1">&#39;0.12.0&#39;</span>

<span class="nb">cd</span> /var/www/alm
bundle install
</code></pre></div>
<h4 id="toc_19">Set ALM configuration settings</h4>

<p>You want to set the MySQL username/password in <code>database.yml</code>, using either the root password that you generated when you installed MySQL, or a different MySQL user. You also want to set the site and session keys in <code>settings.yml</code>, they can be generated with <code>rake secret</code>.</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh"><span class="nb">cd</span> /var/www/alm
cp config/database.yml.example config/database.yml
cp config/settings.yml.example config/settings.yml
</code></pre></div>
<h4 id="toc_20">Install ALM databases</h4>

<p>We just setup an empty database for CouchDB. With MySQL we also include all data to get started, including sample articles and a default user account (username/password <em>articlemetrics</em>). Use <code>RAILS_ENV=production</code> if you set up Passenger to run in the production environment.</p>

<p>It is possible to connect the ALM app to MySQL and/or CouchDB running on a different server, please change <code>host</code> in database.yml and <code>couched_url</code> in settings.yml accordingly.</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh"><span class="nb">cd</span> /var/www/alm
rake db:setup <span class="nv">RAILS_ENV</span><span class="o">=</span>development
curl -X PUT http://localhost:5984/alm/
</code></pre></div>
<h4 id="toc_21">Start Apache</h4>

<p>We are making <code>alm</code> the default site.</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">sudo a2dissite default
sudo a2ensite alm
sudo service apache2 reload
</code></pre></div>
<p>You can now access the ALM application with your web browser at the name or IP address (if it is the only virtual host) of your Ubuntu installation.</p>

<h2 id="toc_22">Using PostgreSQL instead of MySQL</h2>

<p>The instructions above are for using MySQL, but the ALM application can also be installed with PostgreSQL with two small changes:</p>

<h3 id="toc_23">Install PostgreSQL gem</h3>

<p>Uncomment <code>gem &#39;pg&#39;</code> in your <code>Gemfile</code>, comment out <code>gem &#39;mysql2&#39;</code> and run <code>bundle update</code>:</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="n">gem</span> <span class="s1">&#39;rails&#39;</span><span class="p">,</span> <span class="s1">&#39;3.2.16&#39;</span>
<span class="c1">#gem &#39;mysql2&#39;, &#39;0.3.13&#39;</span>
<span class="n">gem</span> <span class="s1">&#39;pg&#39;</span><span class="p">,</span> <span class="s1">&#39;~&gt; 0.17.1&#39;</span>
</code></pre></div>
<h3 id="toc_24">Change database adapter</h3>

<p>Change the adapter in <code>config/database.yml</code> to use PostgreSQL instead of MySQL:</p>
<div class="highlight"><pre><code class="yaml language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">production</span><span class="p-Indicator">:</span>
  <span class="c1">#adapter:   mysql2</span>
  <span class="l-Scalar-Plain">adapter</span><span class="p-Indicator">:</span>   <span class="l-Scalar-Plain">postgresql</span>
  <span class="l-Scalar-Plain">database</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">alm_production</span>
  <span class="l-Scalar-Plain">username</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">postgres</span>
  <span class="l-Scalar-Plain">password</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">YOUR_PASSWORD</span>
  <span class="l-Scalar-Plain">host</span><span class="p-Indicator">:</span>      <span class="l-Scalar-Plain">localhost</span>
  <span class="l-Scalar-Plain">pool</span><span class="p-Indicator">:</span>      <span class="l-Scalar-Plain">10</span>
</code></pre></div>

            <!-- COinS metadata (for citation managers like Zotero etc), goes in body text -->
<span
  class="Z3988"
  title="ctx_ver=Z39.88-2004
  &amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Adc
  &amp;rfr_id=info%3Asid%2Focoins.info%3Agenerator
  &amp;rft.title=Installation
  &amp;rft.creator=
  &amp;rft.date=
  &amp;rft.language=EN
  &amp;rft.rights=CC0
  &amp;rft_id=http://articlemetrics.github.io/docs/installation/">
</span>

            
            <hr>
            <footer class="footer" role="contentinfo">
  <iframe src="http://ghbtns.com/github-btn.html?user=articlemetrics&repo=alm&type=watch&count=true"
  allowtransparency="true" frameborder="0" scrolling="0" width="100" height="20"></iframe>

  <iframe class="github-btn" src="http://ghbtns.com/github-btn.html?user=articlemetrics&repo=alm&type=fork&count=true"
  allowtransparency="true" frameborder="0" scrolling="0" width="100" height="20"></iframe>

  <iframe src="http://ghbtns.com/github-btn.html?user=articlemetrics&type=follow&count=true"
  allowtransparency="true" frameborder="0" scrolling="0" width="180" height="20"></iframe>

  <p>Maintained by the core team with the help of our <a href="/docs/Contributors">contributors</a>.<br/>
  Source code for <a href="https://github.com/articlemetrics/alm">ALM application</a> and <a href="https://github.com/articlemetrics/articlemetrics.github.io">this website</a> available on Github. <br/> Code licensed under <a href="https://github.com/articlemetrics/alm/blob/master/LICENSE.md">Apache 2.0</a>, documentation under <a href="http://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a>.</p>
</div>
          </div>
        </div>


      </div>
    </div> <!-- /container -->

    <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', '']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


    <script src="http://code.jquery.com/jquery.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>