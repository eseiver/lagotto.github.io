<!DOCTYPE html>
<html lang="en">
    <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Installation</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="Martin Fenner" />

    <!-- RDFa Metadata (in DublinCore) -->
    <meta property="dc:title" content="Installation" />
    <meta property="dc:creator" content="" />
    <meta name="citation_publication_date" content=""/>
    <meta property="dc:format" content="text/html" />
    <meta property="dc:language" content="en" />
    <meta property="dc:identifier" content="/docs/installation/" />
    <meta property="dc:rights" content="CC-BY" />
    <meta property="dc:source" content="Article-Level Metrics" />
    <meta property="dc:subject" content="Scholarly Communication" />
    <meta property="dc:type" content="website" />

    <!-- Google Scholar Metadata -->
    <meta name="citation_author" content=""/>
    <meta name="citation_publication_date" content=""/>
    <meta name="citation_title" content="Installation"/>
    <meta name="citation_journal_title" content="Article-Level Metrics"/>

    <link rel="alternate" type="application/rss+xml" title="Article-Level Metrics" href="/rss.xml" />
    <link rel="alternate" type="application/atom+xml" title="Article-Level Metrics" href="/atom.xml" />

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Fonts -->
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600,400italic,600italic' rel='stylesheet' type='text/css'>

    <!-- CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/bootstrap-theme.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/github.css">

    <!-- Javascript -->
    <script src="/js/d3.v3.min.js"></script>
  </head>
  <body>
    <nav class="navbar navbar-inverse navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#">ALM</a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="/">Introduction</a></li>
            <li><a href="/value">Value</a></li>            
            <li><a href="/metrics">Metrics</a></li>
            <li><a href="/research">Research</a></li>  
            <li><a href="/conferences">Conferences</a></li>              
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Implementations <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="/plos">Public Library of Science</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Development <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="/docs/">Home</a></li>
            <li><a href="/docs/installation">Installation</a></li>
            <li><a href="/docs/setup">Setup</a></li>
            <li><a href="/docs/sources">Sources</a></li>
            <li><a href="/docs/api">API</a></li>
            <li><a href="/docs/rake">Rake</a></li>
            <li><a href="/docs/alerts">Alerts</a></li>
            <li><a href="/docs/faq">FAQ</a></li>
            <li><a href="/docs/releases">Releases</a></li>
            <li><a href="/docs/roadmap">Roadmap</a></li>
            <li><a href="/docs/contributors">Contributors</a></li>
          </ul>
        </li>
        <li><a href="/examples">Examples</a></li>
        <li><a href="/blog">Blog</a></li>
        <li><a href="/status">Status</a></li>
      </ul>
    </div>
  </div>
</nav>

    <div class="container">
      <div class="page-header">
        <h1>Installation</h1>
        <p class="subtitle">
        </p>
      </div>

      <div class="content">
        <div class="row">
          <div class="col-md-9">
            
            <h2 id="toc_0">Introduction</h2>

<p>Setting up Lagotto consists of three steps:</p>

<ul>
<li>Installation (this document)</li>
<li><a href="/docs/deployment.md">Deployment</a> if you are using Lagotto in a production system</li>
<li><a href="/docs/setup.md">Setup</a></li>
</ul>

<p>Lagotto is a typical Ruby on Rails web application with one unusual feature: it requires the CouchDB database. CouchDB is used to store the responses from external API calls, MySQL (or PostgreSQL, see below) is used for everything else. The application is used in production systems with Apache/Passenger, Nginx/Passenger and Nginx/Puma. Lagotto uses Ruby on Rails 3.2.x, migration to Rails 4.x is planned for 2014. The application has extensive test coverage using <a href="http://rspec.info/">Rspec</a> and <a href="http://cukes.info/">Cucumber</a>.</p>

<p>Lagotto is Open Source software licensed with a <a href="https://github.com/articlemetrics/lagotto/blob/master/LICENSE.md">MIT License</a>, all dependencies (software and libraries) are also Open Source.</p>

<p>Because of the background workers that talk to external APIs we recommend at least 1 Gb of RAM, and more if you have a large number of articles. As a rule of thumb you need one worker per 5,000 - 20,000 articles, and 1 Gb of RAM per 10 workers - the exact numbers depend on how often you plan to update articles, e.g. you need more workers if you plan on update your usage stats every day.</p>

<h4 id="toc_1">Ruby</h4>

<p>Lagotto requires Ruby 1.9.3 or greater, and has been tested with Ruby 1.9.3, 2.0 and 2.1. Not all Linux distributions include Ruby 1.9 as a standard install. <a href="http://rvm.io/">RVM</a> and <a href="https://github.com/sstephenson/rbenv">Rbenv</a> are Ruby version management tools for installing Ruby, unfortunately they also introduce additional dependencies, making them not the best choices in a production environment. The Chef script below installs Ruby 2.1.</p>

<h4 id="toc_2">Installation Options</h4>

<ul>
<li>automated installation via Vagrant/Chef (recommended)</li>
<li>manual installation</li>
</ul>

<p>Hosting Lagotto at a Platform as a Service (PaaS) provider such as Heroku or OpenShift is possible, but has not been tested.</p>

<h2 id="toc_3">Automated Installation</h2>

<p>This is the recommended way to install the Lagotto. The required applications and libraries will automatically be installed in a self-contained virtual machine running Ubuntu 14.04, using <a href="http://downloads.vagrantup.com/">Vagrant</a> and <a href="http://docs.opscode.com/chef_solo.html">Chef Solo</a>.</p>

<p>Start by downloading and installing <a href="http://downloads.vagrantup.com/">Vagrant</a>, and then install the <a href="https://github.com/schisamo/vagrant-omnibus">Omnibus</a> Vagrant plugin (which installs the newest version of Chef Solo):</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">vagrant plugin install vagrant-omnibus
</code></pre></div>
<p>The following providers have been tested with Lagotto:</p>

<ul>
<li>Virtualbox</li>
<li>VMware Fusion or Workstation</li>
<li>Amazon AWS</li>
<li>Digital Ocean</li>
<li>Rackspace</li>
</ul>

<p>Virtualbox and VMware are for local installations, e.g. on a developer machine, whereas the other options are for cloud installations. With the exception of Virtualbox you need to install the appropriate <a href="https://github.com/mitchellh/vagrant/wiki/Available-Vagrant-Plugins">Vagrant plugin</a> with these providers, e.g. for AWS:</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">vagrant plugin install vagrant-aws
</code></pre></div>
<p>The VMware plugin requires a commercial license, all other plugins are freely available as Open Source software.</p>

<h3 id="toc_4">Custom settings (passwords, API keys)</h3>

<p>This is an optional step. Rename the file <code>config.json.example</code> to <code>config.json</code> and add your custom settings to it, including usernames, passwords, API keys and the MySQL password. This will automatically configure the application with your settings.</p>

<p>Some custom settings for the virtual machine are stored in the <code>Vagrantfile</code>, and that includes your cloud provider access keys, the ID base virtual machine with Ubuntu 14.04 from by your cloud provider, RAM for the virtual machine, and networking settings for a local installation. A sample configuration for AWS would look like:</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provider</span> <span class="ss">:aws</span> <span class="k">do</span> <span class="o">|</span><span class="n">aws</span><span class="p">,</span> <span class="n">override</span><span class="o">|</span>
  <span class="n">aws</span><span class="o">.</span><span class="n">access_key_id</span> <span class="o">=</span> <span class="s2">&quot;EXAMPLE&quot;</span>
  <span class="n">aws</span><span class="o">.</span><span class="n">secret_access_key</span> <span class="o">=</span> <span class="s2">&quot;EXAMPLE&quot;</span>
  <span class="n">aws</span><span class="o">.</span><span class="n">keypair_name</span> <span class="o">=</span> <span class="s2">&quot;EXAMPLE&quot;</span>
  <span class="n">aws</span><span class="o">.</span><span class="n">security_groups</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;EXAMPLE&quot;</span><span class="o">]</span>
  <span class="n">aws</span><span class="o">.</span><span class="n">instance_type</span> <span class="o">=</span> <span class="s2">&quot;m3.medium&quot;</span>
  <span class="n">aws</span><span class="o">.</span><span class="n">ami</span> <span class="o">=</span> <span class="s2">&quot;ami-0307d674&quot;</span>
  <span class="n">aws</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="s2">&quot;eu-west-1&quot;</span>
  <span class="n">aws</span><span class="o">.</span><span class="n">tags</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">Name</span><span class="p">:</span> <span class="s1">&#39;Vagrant Lagotto&#39;</span> <span class="p">}</span>
  <span class="n">override</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">hostname</span> <span class="o">=</span> <span class="s2">&quot;LAGOTTO.EXAMPLE.ORG&quot;</span>
  <span class="n">override</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="s2">&quot;ubuntu&quot;</span>
  <span class="n">override</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">private_key_path</span> <span class="o">=</span> <span class="s2">&quot;~/path/to/ec2/key.pem&quot;</span>
  <span class="n">override</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box_url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/mitchellh/vagrant-aws/raw/master/dummy.box&quot;</span>

  <span class="c1"># Custom parameters for the Lagotto recipe</span>
  <span class="n">chef_overrides</span><span class="o">[</span><span class="s1">&#39;lagotto&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;user&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ubuntu&#39;</span><span class="p">,</span>
    <span class="s1">&#39;group&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ubuntu&#39;</span><span class="p">,</span>
    <span class="s1">&#39;provider&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;aws&#39;</span>
  <span class="p">}</span>

  <span class="n">provision</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">override</span><span class="p">,</span> <span class="n">chef_overrides</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
<p>For Digital Ocean the configuration could look like this:</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provider</span> <span class="ss">:digital_ocean</span> <span class="k">do</span> <span class="o">|</span><span class="n">provider</span><span class="p">,</span> <span class="n">override</span><span class="o">|</span>
  <span class="n">override</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">private_key_path</span> <span class="o">=</span> <span class="s1">&#39;~/YOUR_PRIVATE_SSH_KEY&#39;</span>
  <span class="n">override</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box</span> <span class="o">=</span> <span class="s1">&#39;digital_ocean&#39;</span>
  <span class="n">override</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box_url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/smdahlen/vagrant-digitalocean/raw/master/box/digital_ocean.box&quot;</span>
  <span class="n">override</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="s2">&quot;ubuntu&quot;</span>

  <span class="n">provider</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="s1">&#39;nyc2&#39;</span>
  <span class="n">provider</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="s1">&#39;Ubuntu 14.04 x64&#39;</span>
  <span class="n">provider</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="s1">&#39;1GB&#39;</span>

  <span class="c1"># please configure</span>
  <span class="n">override</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">hostname</span> <span class="o">=</span> <span class="s2">&quot;LAGOTTO.EXAMPLE.ORG&quot;</span>
  <span class="n">provider</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="s1">&#39;EXAMPLE&#39;</span>

  <span class="n">provision</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">override</span><span class="p">,</span> <span class="n">chef_overrides</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
<p>The sample configurations for AWS and Digital Ocean is included in the <code>Vagrantfile</code>.</p>

<h3 id="toc_5">Cookbooks</h3>

<p>The <a href="https://supermarket.getchef.com/">Chef cookbooks</a> needed by the Lagotto cookbook are managed by <a href="https://github.com/applicationsonline/librarian-chef">librarian-chef</a>, which is installed as a Ruby gem:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">gem install librarian-chef
</code></pre></div>
<p>The required cookbooks are listed in the <code>Cheffile</code>, and are automatically installed into <code>vendor/cookbooks</code>.</p>

<h3 id="toc_6">Installation</h3>

<p>Then install all the required software for Lagotto with:</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">git clone git://github.com/articlemetrics/lagotto.git
<span class="nb">cd </span>lagotto
vagrant up
</code></pre></div>
<p>This can take up to 15 min, future updates with <code>vagrant provision</code> are of course much faster. To get into in the virtual machine, use ssh and then switch to the directory of the application:</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">vagrant ssh
<span class="nb">cd</span> /var/www/lagotto/current
</code></pre></div>
<p>This uses the private SSH key provided by you in the <code>Vagrantfile</code> (the default insecure key for local installations using Virtualbox is <code>~/.vagrant.d/insecure_private_key</code>). The <code>vagrant</code> user has sudo privileges. The MySQL password is stored at <code>config/database.yml</code>, and is auto-generated during the installation. CouchDB is set up to run in <strong>Admin Party</strong> mode, i.e. without usernames or passwords. The database servers can be reached from the virtual machine or via port forwarding. Vagrant syncs the folder on the host containing the checked out Lagotto git repo with the folder <code>/var/www/lagotto/current</code> on the guest.</p>

<h2 id="toc_7">Manual installation</h2>

<p>These instructions assume a fresh installation of Ubuntu 14.04 and a user with sudo privileges. Installation on other Unix/Linux platforms should be similar, but may require additional steps to install a recent Ruby (at least 1.9.3 is required).</p>

<h4 id="toc_8">Add PPAs to install more recent versions of Ruby and CouchDB, and Nginx/Passeger</h4>

<p>We only need one Ruby version and manage gems with bundler, so there is no need to install <code>rvm</code> or <code>rbenv</code>. We want to install the latest CouchDB version from the official PPA, and we want to install Nginx precompiled with Passenger.</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">sudo apt-get install python-software-properties
sudo apt-add-repository ppa:brightbox/ruby-ng
sudo add-apt-repository ppa:couchdb/stable

sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 561F9B9CAC40B2F7
sudo apt-get install apt-transport-https ca-certificates
deb https://oss-binaries.phusionpassenger.com/apt/passenger trusty main
sudo chown root: /etc/apt/sources.list.d/passenger.list
sudo chmod 600 /etc/apt/sources.list.d/passenger.list
</code></pre></div>
<h4 id="toc_9">Update package lists</h4>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">sudo apt-get update
</code></pre></div>
<h4 id="toc_10">Install Ruby and required packages</h4>

<p>Also install the <code>curl</code> and <code>git</code> packages, the <code>libmysqlclient-dev</code> library required by the <code>myslq2</code> gem, the <code>libpq-dev</code> library required by the <code>pg</code>gem, and <code>nodejs</code> as Javascript runtime. When running Lagotto on a local machine we also want to install <code>avahi-daemon</code> and <code>libnss-mdns</code>for zeroconf networking.</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">sudo apt-get install ruby2.1 ruby2.1-dev curl git libmysqlclient-dev nodejs avahi-daemon libnss-mdns
</code></pre></div>
<h4 id="toc_11">Install databases</h4>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">sudo apt-get install couchdb mysql-server
</code></pre></div>
<h4 id="toc_12">Install Memcached</h4>

<p>Memcached is used to cache requests (in particular API requests), and the default configuration can be used. If you want to run memcached on a different host, change <code>config.cache_store = :dalli_store, { :namespace =&gt; &quot;lagotto&quot; }</code> in <code>config/environments/production.rb</code> to <code>config.cache_store = :dalli_store, &#39;cache.example.com&#39;, { :namespace =&gt; &quot;lagotto&quot; }</code>.</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">sudo apt-get install memcached
</code></pre></div>
<h4 id="toc_13">Install Postfix</h4>

<p>Postfix is used to send reports via email. Alternatively, a different SMTP host can be configured in <code>config/settings.yml</code>.</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">sudo apt-get install postfix
</code></pre></div>
<p>The default configuration assumes <code>address: localhost</code>, <code>port: 25</code>. You can configure mail in <code>config/settings.yml</code>:</p>
<div class="highlight"><pre><code class="yaml language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">mail</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">address</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">port</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">domain</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">user_name</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">password</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">authentication</span><span class="p-Indicator">:</span>
</code></pre></div>
<p>More information can be found <a href="http://guides.rubyonrails.org/action_mailer_basics.html">here</a>.</p>

<h4 id="toc_14">Install Nginx with Passenger</h4>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">sudo apt-get install nginx-full passenger
</code></pre></div>
<p>Edit <code>/etc/nginx/nginx.conf</code> and uncomment <code>passenger_root</code> and <code>passenger_ruby</code>.</p>

<h4 id="toc_15">Set up Nginx virtual host</h4>

<p>Please set <code>server_name</code> if you have set up more than one virtual host. Use <code>passenger_app_env development</code> to use the Rails development environment.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">server {
  listen 80 default_server;
  server_name EXAMPLE.ORG;
  root /var/www/lagotto/current/public;
  access_log /var/log/nginx/lagotto.access.log;
  passenger_enabled on;
  passenger_app_env production;
}
</code></pre></div>
<h4 id="toc_16">Install Lagotto code</h4>

<p>You may have to set the permissions first, depending on your server setup. Passenger by default is run by the user who owns <code>config.ru</code>.</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">dd /var/www
git clone git://github.com/articlemetrics/lagotto.git
</code></pre></div>
<h4 id="toc_17">Install Bundler and Ruby gems required by the application</h4>

<p>Bundler is a tool to manage dependencies of Ruby applications: <a href="http://gembundler.com">http://gembundler.com</a>.</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">sudo gem install bundler

<span class="nb">cd</span> /var/www/lagotto
bundle install
</code></pre></div>
<h4 id="toc_18">Set Lagotto configuration settings</h4>

<p>You want to set the MySQL username/password in <code>database.yml</code>, using either the root password that you generated when you installed MySQL, or a different MySQL user. You also want to set the site and session keys in <code>settings.yml</code>, they can be generated with <code>rake secret</code>.</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh"><span class="nb">cd</span> /var/www/lagotto
cp config/database.yml.example config/database.yml
cp config/settings.yml.example config/settings.yml
</code></pre></div>
<h4 id="toc_19">Install Lagotto databases</h4>

<p>We just setup an empty database for CouchDB. With MySQL we also include all data to get started, including sample articles and a default user account (username/password <em>articlemetrics</em>). Use <code>RAILS_ENV=production</code> if you set up Passenger to run in the production environment.</p>

<p>It is possible to connect Lagotto to MySQL and/or CouchDB running on a different server, please change <code>host</code> in database.yml and <code>couched_url</code> in settings.yml accordingly.</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh"><span class="nb">cd</span> /var/www/lagotto
rake db:setup <span class="nv">RAILS_ENV</span><span class="o">=</span>production
curl -X PUT http://localhost:5984/lagotto/
</code></pre></div>
<h4 id="toc_20">Restart Nginx</h4>

<p>We are making <code>lagotto</code> the default site.</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">sudo service nginx restart
</code></pre></div>
<p>You can now access the Lagotto application with your web browser at the name or IP address of your Ubuntu installation.</p>

<h2 id="toc_21">Using PostgreSQL instead of MySQL</h2>

<p>The instructions above are for using MySQL, but Lagotto can also be installed with PostgreSQL by changing the database adapter in <code>config/database.yml</code> to use PostgreSQL instead of MySQL (change the line in defaults to <code>&lt;&lt;:postgres</code>):</p>
<div class="highlight"><pre><code class="yaml language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">mysql</span><span class="p-Indicator">:</span> <span class="nl">&amp;mysql</span>
  <span class="l-Scalar-Plain">adapter</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">mysql2</span>
  <span class="l-Scalar-Plain">username</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">root</span>
  <span class="l-Scalar-Plain">password</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">YOUR_PASSWORD</span>

<span class="l-Scalar-Plain">postgresql</span><span class="p-Indicator">:</span> <span class="nl">&amp;postgres</span>
  <span class="l-Scalar-Plain">adapter</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">postgresql</span>
  <span class="l-Scalar-Plain">username</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">postgres</span>
  <span class="l-Scalar-Plain">password</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">YOUR_PASSWORD</span>
  <span class="l-Scalar-Plain">pool</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">10</span>
  <span class="l-Scalar-Plain">min_messages</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">ERROR</span>

<span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span> <span class="nl">&amp;defaults</span>
  <span class="l-Scalar-Plain">pool</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">5</span>
  <span class="l-Scalar-Plain">timeout</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">5000</span>
  <span class="l-Scalar-Plain">database</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">lagotto_&lt;%= Rails.env %&gt;</span>
  <span class="l-Scalar-Plain">host</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">localhost</span>

  <span class="l-Scalar-Plain">&lt;&lt;</span><span class="p-Indicator">:</span> <span class="err">*</span><span class="l-Scalar-Plain">&lt;%= ENV[&#39;DB&#39;] || &quot;mysql&quot; %&gt;</span>

<span class="l-Scalar-Plain">development</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">&lt;&lt;</span><span class="p-Indicator">:</span> <span class="nv">*defaults</span>

<span class="l-Scalar-Plain">test</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">&lt;&lt;</span><span class="p-Indicator">:</span> <span class="nv">*defaults</span>

<span class="l-Scalar-Plain">production</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">&lt;&lt;</span><span class="p-Indicator">:</span> <span class="nv">*defaults</span>
</code></pre></div>
<h2 id="toc_22">Running Lagotto on multiple servers</h2>

<p>Lagotto was developed to run on a single server, but most components scale to multiple servers. When running Lagotto on multiple servers, make sure that:</p>

<ul>
<li>the name used in the load balancer is set as <code>public_server</code> in <code>config/settings.yml</code></li>
<li>memcached should be set up as a cluster by adding a <code>web_servers</code> list with all Lagotto servers behind the load balancer to <code>config/settings.yml</code>, e.g. <code>web_servers: [example1.org, example2.org]</code></li>
<li>workers should run on only one server (work is in progress to scale to multiple servers), e.g. the server with the capistrano <code>:db</code> role</li>
<li>database maintenance rake tasks should run on only one server, capistrano defaults to install the cron jobs only for the <code>:db</code> role.</li>
<li>mail services (sending emails) should run on only one server. They are part of the database maintenance tasks, so by default run only on the server with the <code>:db</code> role.</li>
</ul>


            <!-- COinS metadata (for citation managers like Zotero etc), goes in body text -->
<span
  class="Z3988"
  title="ctx_ver=Z39.88-2004
  &amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Adc
  &amp;rfr_id=info%3Asid%2Focoins.info%3Agenerator
  &amp;rft.title=Installation
  &amp;rft.creator=
  &amp;rft.date=
  &amp;rft.language=EN
  &amp;rft.rights=CC0
  &amp;rft_id=http://articlemetrics.github.io/docs/installation/">
</span>

            
            <hr>
            <footer class="footer" role="contentinfo">
  <iframe src="http://ghbtns.com/github-btn.html?user=articlemetrics&repo=alm&type=watch&count=true"
  allowtransparency="true" frameborder="0" scrolling="0" width="100" height="20"></iframe>

  <iframe class="github-btn" src="http://ghbtns.com/github-btn.html?user=articlemetrics&repo=alm&type=fork&count=true"
  allowtransparency="true" frameborder="0" scrolling="0" width="100" height="20"></iframe>

  <iframe src="http://ghbtns.com/github-btn.html?user=articlemetrics&type=follow&count=true"
  allowtransparency="true" frameborder="0" scrolling="0" width="180" height="20"></iframe>

  <p>Maintained by the core team with the help of our <a href="/docs/Contributors">contributors</a>.<br/>
  Source code for <a href="https://github.com/articlemetrics/alm">ALM application</a> and <a href="https://github.com/articlemetrics/articlemetrics.github.io">this website</a> available on Github. <br/> Code licensed under <a href="https://github.com/articlemetrics/alm/blob/master/LICENSE.md">Apache 2.0</a>, documentation under <a href="http://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a>.</p>
</div>
          </div>
        </div>


      </div>
    </div> <!-- /container -->

    <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', '']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


    <script src="http://code.jquery.com/jquery.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>